<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <title>请假申请</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link href="css/mui.min.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="css/same.css" />
    <link rel="stylesheet" type="text/css" href="css/mui.dtpicker.css" />
    <link rel="stylesheet" type="text/css" href="css/mui.picker.min.css" />
    <link rel="stylesheet" type="text/css" href="css/mui.poppicker.css" />
    <style type="text/css">
        body {
            background-color: #FFFFFF;
        }

        .typelist {
            padding: 0px;
            width: 65%;
            float: right;
            line-height: 42px;
            font-size: 14px;
        }

        /*.time {
				display: -webkit-box;
				display: -webkit-flex;
				display: flex;
				margin-bottom: 10px;
			}*/

        .mui-input-row .mui-btn {
            width: 25%;
        }

        .time .mui-btn-block {
            padding: 8px px;
            margin-bottom: 0;
            font-size: 12px;
            border: none;
            border-radius: 5px;
            color: #C0C0C0;
        }

        .submit {
            border: none;
            width: 100%;
            margin-top: 20px;
        }

        /*去除mui-input-group 顶部和底部边框*/

        .mui-input-group:before {
            height: 0
        }

        .mui-input-group:after {
            height: 0
        }
    </style>
</head>

<body>
    <header class="mui-bar mui-bar-nav">
        <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
        <a href="index.html">
            <img src="images/close.png" />
        </a>
        <h1 class="mui-title">请假申请</h1>
    </header>
    <div>
        <div class="mui-content" id="app">
            <form action="" method="post" class="mui-input-group">
                <div class="mui-input-row" style="margin-top: 60px;">
                    <label>标题</label>
                    <input type="text" v-model="form.title" class="mui-input-clear" placeholder="xxx的请假申请">
                </div>
                <div class="mui-input-row">
                    <label>请假类型</label>
                    <span class="typelist mui-navigate-right">
                        <select name="" v-model="form.type">
                            <option value="年休假">年休假</option>
                            <option value="事假">事假</option>
                            <option value="病假">病假</option>
                            <option value="婚假">婚假</option>
                            <option value="产假">产假</option>
                            <option value="陪产假">陪产假</option>
                            <option value="哺乳假">哺乳假</option>
                            <option value="工伤假">工伤假</option>
                            <option value="看护假">看护假</option>
                            <option value="丧假">丧假</option>
                            <option value="工伤假">工伤假</option>
                        </select>
                    </span>
                </div>
                <div class="mui-input-row">
                    <label>开始时间</label>
                    <div class="time">
                        <input name="starttime" v-model="form.start_date" id="starttime" value="">
                        <!-- <button id='startbtn' class="startbtn mui-btn mui-btn-block mui-navigate-right">请选择 </button> -->
                    </div>
                </div>
                <div class="mui-input-row">
                    <label>结束时间</label>
                    <div class="time">
                        <input name="stopttime" v-model="form.stop_date"  id="stopttime" value="">
                        <!-- <button id='stoptbtn' class="stoptbtn mui-btn mui-btn-block mui-navigate-right">请选择 </button> -->
                    </div>
                </div>
                <div class="mui-input-row">
                    <label for="">请假天数</label>
                    <input type="text" id="days" v-model="form.count" class="mui-input-clear" value="" placeholder="请输入" />
                </div>
                <div class="mui-input-row" style="width: 100%;height: 10%;">
                    <label for="" style="display: inline-block;">请假事由</label>
                    <textarea id="textarea" rows="5" v-model="form.reason" placeholder="请输入" class="mui-input-clear"></textarea>
                </div>
                <!--<div class="mui-input-row">
					<button type="button" class="submit mui-btn mui-btn-block">提交</button>
				</div>-->
                <button type="button" @click="addLeave" class="submit mui-btn mui-btn-block">提交</button>
            </form>
        </div>
    </div>
    <script src="js/mui.min.js"></script>
    <script src="js/mui.poppicker.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/mui.picker.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/mui.dtpicker.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript">
        mui.init({
            swipeBack: true //启用右滑关闭功能
        });

        //开始时间
        (function ($, doc) {
            var _getParam = function (obj, param) {
                return obj[param] || '';
            };
            var cityPicker3 = new $.PopPicker({
                layer: 3
            });
            
            // 开始时间
            var starttime = doc.getElementById('starttime').value;
            //					var starttime = $('#starttime').val();
            var startbtn = doc.getElementsByClassName('startbtn')[0];
            //					var startbtn =$('.startbtn')				
            startbtn.addEventListener('tap', function () {
                
                var optionsJson = this.getAttribute('data-options') || '{}';
                var options = JSON.parse(optionsJson);
                var id = this.getAttribute('id');
                var picker = new $.DtPicker({
                    type: "date", //设置日历初始化
                    beginYear: 1990, //设置开始日期
                    endDate: 2120 //设置结束日期
                });
                picker.show(function (rs) {
                    /*
                     * rs.value 拼合后的 value
                     * rs.text 拼合后的 text
                     * rs.y 年，可以通过 rs.y.vaue 和 rs.y.text 获取值和文本
                     * rs.m 月，用法同年
                     * rs.d 日，用法同年
                     * rs.h 时，用法同年
                     * rs.i 分（minutes 的第二个字母），用法同年
                     */
                    startbtn.innerText = rs.text;
                    starttime = rs.text;
                    /*
                     * 返回 false 可以阻止选择框的关闭
                     * return false;
                     */
                    /*
                     * 释放组件资源，释放后将将不能再操作组件
                     * 通常情况下，不需要示放组件，new DtPicker(options) 后，可以一直使用。
                     * 当前示例，因为内容较多，如不进行资原释放，在某些设备上会较慢。
                     * 所以每次用完便立即调用 dispose 进行释放，下次用时再创建新实例。
                     */
                    picker.dispose();
                });
            }, false);

            //结束时间
            var stoptime = doc.getElementById('stopttime').value;
            //					var starttime = $('#starttime').val();
            var stopbtn = doc.getElementsByClassName('stoptbtn')[0];
            //					var startbtn =$('.startbtn')
            stopbtn.addEventListener('tap', function () {
                var optionsJson = this.getAttribute('data-options') || '{}';
                var options = JSON.parse(optionsJson);
                var id = this.getAttribute('id');
                var picker = new $.DtPicker({
                    type: "date", //设置日历初始化
                    beginYear: 1990, //设置开始日期
                    endDate: 2120 //设置结束日期
                });
                picker.show(function (rs) {
                    /*
                     * rs.value 拼合后的 value
                     * rs.text 拼合后的 text
                     * rs.y 年，可以通过 rs.y.vaue 和 rs.y.text 获取值和文本
                     * rs.m 月，用法同年
                     * rs.d 日，用法同年
                     * rs.h 时，用法同年
                     * rs.i 分（minutes 的第二个字母），用法同年
                     */
                    stopbtn.innerText = rs.text;
                    stoptime = rs.text;
                    /*
                     * 返回 false 可以阻止选择框的关闭
                     * return false;
                     */
                    /*
                     * 释放组件资源，释放后将将不能再操作组件
                     * 通常情况下，不需要示放组件，new DtPicker(options) 后，可以一直使用。
                     * 当前示例，因为内容较多，如不进行资原释放，在某些设备上会较慢。
                     * 所以每次用完便立即调用 dispose 进行释放，下次用时再创建新实例。
                     */
                    picker.dispose();
                });
            }, false);

        })(mui, document);
    </script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <!-- import { userInfo} from "js/sqlMap.js"; -->

    <script>

        const instance = axios.create({
            baseURL: 'http://localhost:3000/api/base/', // api 的 base_url

        })

        Vue.prototype.$http = instance;

        new Vue({
            el: '#app',
            data: {
                form: {
                    start_date:'2019-05-08 21:22:52',
                    stop_date:'2019-05-29 21:22:52'

                },

            },
            created() {
                this.request();
            },
            methods: {
                request() {
                    if (!localStorage.getItem('userInfo')) {
                        location.href = "./login.html"
                    }
                    
                },
                addLeave() {
                    var userInfo = JSON.parse(localStorage.getItem('userInfo'))
                    this.form.uid = userInfo.id
                    debugger
                    this.$http.post("insert", { table: 'leave', data: this.form }).then(res => {
                        // this.$router.push('/Login');
                        // location.href="./login.html"
                    });
                },
            }
        })
    </script>
</body>

</html>